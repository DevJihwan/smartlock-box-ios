# Bug Fix History - 2025.11.01

## ê°œìš”
SmartLockBox iOS í”„ë¡œì íŠ¸ì˜ ë¹Œë“œ ì˜¤ë¥˜ ìˆ˜ì • ë‚´ì—­ì„ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

---

## ğŸ› ìˆ˜ì •ëœ ë²„ê·¸ ëª©ë¡

### 1. AIEvaluationService.swift - ìœ ë‹ˆì½”ë“œ ì´ìŠ¤ì¼€ì´í”„ ì˜¤ë¥˜

**ì˜¤ë¥˜ ìœ„ì¹˜:** `SmartLockBox/Services/AIEvaluationService.swift:169:325`

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```
Expected hexadecimal code in braces after unicode escape
```

**ì›ì¸:**
- ì˜ëª»ëœ ìœ ë‹ˆì½”ë“œ ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ `\ub85c` ì‚¬ìš©
- Swiftì—ì„œ ìœ ë‹ˆì½”ë“œëŠ” `\u{XXXX}` í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•¨

**ìˆ˜ì • ë‚´ìš©:**
```swift
// ìˆ˜ì • ì „
"ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ {\"result\": \"PASS\", \"feedback\": \"...\"}\\ub85c ì‘ì„±í•˜ì„¸ìš”."

// ìˆ˜ì • í›„
"ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ {\"result\": \"PASS\", \"feedback\": \"...\"} ë˜ëŠ” {\"result\": \"FAIL\", \"feedback\": \"...\"}ë¡œ ì‘ì„±í•˜ì„¸ìš”."
```

**ì»¤ë°‹:**
- SHA: `fb790edcd07d45c9852ed9a49b617b26047754df`
- Message: "Fix unicode escape error in AIEvaluationService.swift"

---

### 2. Colors.swift - SwiftUI View Modifier ì˜¤ë¥˜

**ì˜¤ë¥˜ ìœ„ì¹˜:** `SmartLockBox/Utils/Colors.swift`

#### 2-1. Color.shadow() ë©”ì„œë“œ ì¡´ì¬í•˜ì§€ ì•ŠìŒ (103ë²ˆ ì¤„)

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```
Instance member 'shadow' cannot be used on type 'Color'
```

**ì›ì¸:**
- `shadow()`ëŠ” `View` modifierì´ì§€ `Color`ì˜ static ë©”ì„œë“œê°€ ì•„ë‹˜
- `Color` extensionì—ì„œ `shadow()`ë¥¼ ì§ì ‘ í˜¸ì¶œí•  ìˆ˜ ì—†ìŒ

**ìˆ˜ì • ë‚´ìš©:**
- `dynamicShadow()` í•¨ìˆ˜ë¥¼ `ViewModifier`ë¡œ ë³€ê²½
- `@Environment(\.colorScheme)`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤í¬ëª¨ë“œ ê°ì§€

```swift
// ìˆ˜ì • ì „
extension Color {
    static func dynamicShadow(...) -> some View {
        return AnyView(shadow(...))
    }
}

// ìˆ˜ì • í›„
struct DynamicShadowModifier: ViewModifier {
    @Environment(\.colorScheme) var colorScheme
    let radius: CGFloat
    let opacity: Double
    
    func body(content: Content) -> some View {
        content.shadow(...)
    }
}
```

#### 2-2. colorScheme í™˜ê²½ ë³€ìˆ˜ ë¯¸ì„ ì–¸ (117, 122ë²ˆ ì¤„)

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```
Cannot convert value of type '(ColorScheme) -> some View' to expected argument type 'ColorScheme'
```

**ì›ì¸:**
- `cardStyle()`, `adaptiveShadow()` í•¨ìˆ˜ì—ì„œ `colorScheme` ë³€ìˆ˜ë¥¼ ì„ ì–¸ ì—†ì´ ì‚¬ìš©
- SwiftUIì˜ `@Environment(\.colorScheme)`ë¥¼ í†µí•´ ì ‘ê·¼í•´ì•¼ í•¨

**ìˆ˜ì • ë‚´ìš©:**
- View extensionì˜ í•¨ìˆ˜ë“¤ì„ `ViewModifier`ë¡œ ë¦¬íŒ©í† ë§
- ê° Modifierì—ì„œ `@Environment(\.colorScheme)` ì„ ì–¸

```swift
// ìˆ˜ì • ì „
extension View {
    func cardStyle() -> some View {
        self.shadow(color: colorScheme == .dark ? ... : ...)
    }
}

// ìˆ˜ì • í›„
extension View {
    func cardStyle() -> some View {
        self.modifier(CardStyleModifier())
    }
}

struct CardStyleModifier: ViewModifier {
    @Environment(\.colorScheme) var colorScheme
    
    func body(content: Content) -> some View {
        content
            .padding()
            .background(AppColors.cardBackground)
            .cornerRadius(16)
            .shadow(
                color: Color.black.opacity(colorScheme == .dark ? 0.3 : 0.1),
                radius: 10,
                x: 0,
                y: 5
            )
    }
}
```

#### 2-3. EnvironmentKey íƒ€ì… ì‚¬ìš© ì˜¤ë¥˜ (126ë²ˆ ì¤„)

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```
Use of protocol 'EnvironmentKey' as a type must be written 'any EnvironmentKey'
```

**ì›ì¸:**
- ë¶ˆí•„ìš”í•œ `environment(key:)` í•¨ìˆ˜ ì •ì˜
- `EnvironmentKey` í”„ë¡œí† ì½œì„ íƒ€ì…ìœ¼ë¡œ ì§ì ‘ ì‚¬ìš©í•˜ë ¤ê³  ì‹œë„

**ìˆ˜ì • ë‚´ìš©:**
- ì˜ëª» ì‘ì„±ëœ `environment(key:)` í•¨ìˆ˜ ì œê±°
- ViewModifier íŒ¨í„´ìœ¼ë¡œ ì™„ì „íˆ ëŒ€ì²´

**ìƒì„±ëœ ViewModifierë“¤:**
1. `CardStyleModifier` - ì¹´ë“œ ìŠ¤íƒ€ì¼ ì ìš©
2. `AdaptiveShadowModifier` - ì ì‘í˜• ê·¸ë¦¼ì íš¨ê³¼
3. `DynamicShadowModifier` - ë™ì  ê·¸ë¦¼ì íš¨ê³¼

**ì»¤ë°‹:**
- SHA: `a20e53baec0b2a49decf2b1c2dfed053bbb96f68`
- Message: "Fix Colors.swift: remove invalid Color.shadow usage and fix environment key issues"

---

### 3. Core Data Entity Class íŒŒì¼ ëˆ„ë½

**ì˜¤ë¥˜ ìœ„ì¹˜:**
```
/Build/Intermediates.noindex/SmartLockBox.build/Debug-iphonesimulator/SmartLockBox.build/DerivedSources/CoreDataGenerated/SmartLockBox/
```

#### 3-1. UnlockAttempt+CoreDataProperties.swift ì˜¤ë¥˜

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```
Cannot find type 'UnlockAttempt' in scope
```

**ì›ì¸:**
- `UnlockAttempt+CoreDataClass.swift` íŒŒì¼ì´ í”„ë¡œì íŠ¸ì— ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- Xcodeê°€ ìë™ ìƒì„±í•œ Properties íŒŒì¼ì´ Class íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ

#### 3-2. UsageRecord+CoreDataProperties.swift ì˜¤ë¥˜

**ì˜¤ë¥˜ ë©”ì‹œì§€:**
```
Cannot find type 'UsageRecord' in scope
```

**ì›ì¸:**
- `UsageRecord+CoreDataClass.swift` íŒŒì¼ì´ í”„ë¡œì íŠ¸ì— ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- Xcodeê°€ ìë™ ìƒì„±í•œ Properties íŒŒì¼ì´ Class íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ

**ìˆ˜ì • ë‚´ìš©:**
ëˆ„ë½ëœ Core Data Entity Class íŒŒì¼ë“¤ì„ ìƒì„±:

1. **UnlockAttempt+CoreDataClass.swift**
```swift
import Foundation
import CoreData

@objc(UnlockAttempt)
public class UnlockAttempt: NSManagedObject {
    // Core Data entity class for UnlockAttempt
    // Properties are defined in UnlockAttempt+CoreDataProperties.swift
}
```

2. **UsageRecord+CoreDataClass.swift**
```swift
import Foundation
import CoreData

@objc(UsageRecord)
public class UsageRecord: NSManagedObject {
    // Core Data entity class for UsageRecord
    // Properties are defined in UsageRecord+CoreDataProperties.swift
}
```

**Entity ì†ì„± (ì¶”ì •):**

**UnlockAttempt:**
- `id: UUID`
- `timestamp: Date`
- `word1: String`
- `word2: String`
- `sentence: String`
- `chatGPTResult: String`
- `claudeResult: String`
- `isSuccessful: Bool`

**UsageRecord:**
- `id: UUID`
- `date: Date`
- `usageMinutes: Int32`
- `goalMinutes: Int32`
- `isGoalAchieved: Bool`

**ì»¤ë°‹:**
- SHA: `aeee9855c4e889bc5205547925f9bbb3c95d2f98`
- Message: "Add missing Core Data entity class files for UnlockAttempt and UsageRecord"

---

## ğŸ“‹ Core Data Codegen ì„¤ì • ê¶Œì¥ì‚¬í•­

`.xcdatamodeld` íŒŒì¼ì—ì„œ ê° Entityì˜ **Codegen** ì„¤ì •:

- **Category/Extension** (ê¶Œì¥) âœ…
  - Xcodeê°€ Properties íŒŒì¼ë§Œ ìë™ ìƒì„±
  - Class íŒŒì¼ì€ ê°œë°œìê°€ ì§ì ‘ ê´€ë¦¬
  - ë” ë‚˜ì€ ë²„ì „ ê´€ë¦¬ ê°€ëŠ¥

- **Class Definition**
  - Xcodeê°€ Classì™€ Properties íŒŒì¼ ëª¨ë‘ ìë™ ìƒì„±
  - DerivedDataì—ë§Œ ì¡´ì¬í•˜ì—¬ Gitì— í¬í•¨ë˜ì§€ ì•ŠìŒ
  - ë²„ì „ ê´€ë¦¬ ì–´ë ¤ì›€

- **Manual/None**
  - ëª¨ë“  íŒŒì¼ì„ ê°œë°œìê°€ ì§ì ‘ ìƒì„± ë° ê´€ë¦¬
  - ì™„ì „í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥í•˜ì§€ë§Œ ìœ ì§€ë³´ìˆ˜ ë¶€ë‹´ ì¦ê°€

---

## ğŸ”§ ë¹Œë“œ ì˜¤ë¥˜ í•´ê²° ì ˆì°¨

ìˆ˜ì • í›„ ë¹Œë“œê°€ ì•ˆ ë  ê²½ìš° ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼ ì§„í–‰:

1. **Clean Build Folder**
   ```
   Xcode > Product > Clean Build Folder (âŒ˜ + Shift + K)
   ```

2. **DerivedData ì‚­ì œ**
   ```bash
   rm -rf ~/Library/Developer/Xcode/DerivedData/SmartLockBox-*
   ```

3. **í”„ë¡œì íŠ¸ ì¬ë¹Œë“œ**
   ```
   Xcode > Product > Build (âŒ˜ + B)
   ```

---

## ğŸ“Š ìˆ˜ì • í†µê³„

| ë¶„ë¥˜ | íŒŒì¼ ìˆ˜ | ìˆ˜ì • ë¼ì¸ | ì¶”ê°€ íŒŒì¼ |
|------|---------|-----------|-----------|
| ìœ ë‹ˆì½”ë“œ ì˜¤ë¥˜ | 1 | ~3 | 0 |
| SwiftUI ì˜¤ë¥˜ | 1 | ~50 | 3 modifiers |
| Core Data ì˜¤ë¥˜ | 0 | 0 | 2 |
| **í•©ê³„** | **2** | **~53** | **2+3** |

---

## âœ… ê²€ì¦ ì™„ë£Œ

ëª¨ë“  ë¹Œë“œ ì˜¤ë¥˜ê°€ í•´ê²°ë˜ì—ˆìœ¼ë©°, í”„ë¡œì íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì»´íŒŒì¼ë©ë‹ˆë‹¤.

### ìˆ˜ì •ëœ ë¹Œë“œ ì˜¤ë¥˜ ìš”ì•½:
1. âœ… AIEvaluationService.swift - ìœ ë‹ˆì½”ë“œ ì´ìŠ¤ì¼€ì´í”„ ì˜¤ë¥˜
2. âœ… Colors.swift - Color.shadow() ì‚¬ìš© ì˜¤ë¥˜
3. âœ… Colors.swift - colorScheme í™˜ê²½ ë³€ìˆ˜ ì˜¤ë¥˜ (2ê±´)
4. âœ… Colors.swift - EnvironmentKey íƒ€ì… ì˜¤ë¥˜
5. âœ… UnlockAttempt Core Data Class ëˆ„ë½
6. âœ… UsageRecord Core Data Class ëˆ„ë½

**ì´ 7ê°œì˜ ë¹Œë“œ ì˜¤ë¥˜ í•´ê²° ì™„ë£Œ**

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Swift Unicode Escapes](https://docs.swift.org/swift-book/documentation/the-swift-programming-language/stringsandcharacters/#Unicode)
- [SwiftUI Environment Values](https://developer.apple.com/documentation/swiftui/environment)
- [Core Data Codegen](https://developer.apple.com/documentation/coredata/modeling_data/generating_code)
- [SwiftUI ViewModifier](https://developer.apple.com/documentation/swiftui/viewmodifier)

---

**ì‘ì„±ì¼:** 2025ë…„ 11ì›” 1ì¼  
**ì‘ì„±ì:** DevJihwan  
**í”„ë¡œì íŠ¸:** SmartLockBox iOS
